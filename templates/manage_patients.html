{% extends "base.html" %} {% block title%}Manage Patients{% endblock %} {% block
content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Manage Patients</h2>
    <a
      href="{{ url_for('admin_register_patient') if 'admin_register_patient' in globals() else '#' }}"
      class="btn btn-primary"
      >Add Patient</a
    >
  </div>

  {% if patients %}
  <table class="table table-striped">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Age</th>
        <th>Contact</th>
        <th>Email</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for p in patients %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ p.user.name if p.user else ('Patient ' ~ p.id) }}</td>
        <td>{{ p.age if p.age else '-' }}</td>
        <td>{{ p.contact if p.contact else '-' }}</td>
        <td>{{ p.user.email if p.user else '-' }}</td>
        <td>
          <a
            href="{{ url_for('admin_view_patient_history') }}?patient_id={{ p.id }}"
            class="btn btn-sm btn-outline-primary"
            >History</a
          >
          <a
            href="{{ url_for('admin_edit_patient', patient_id=p.id) if 'admin_edit_patient' in globals() else '#' }}"
            class="btn btn-sm btn-outline-primary"
            >Edit</a
          >
          <form
            action="{{ url_for('admin_delete_patient', patient_id=p.id) }}"
            method="post"
            style="display: inline"
          >
            <button
              type="submit"
              class="btn btn-sm btn-danger"
              onclick="return confirm('Delete Patient?')"
            >
              Delete
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No Patients found.</p>
  {% endif %}
</div>
{% endblock %}
